{% extends 'base.html.twig' %}

{% block title %}Emoji Quiz - Jouer{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <style>
        :root {
            --primary: #FF6B6B;
            --secondary: #4ECDC4;
            --dark: #292F36;
            --light: #F7FFF7;
            --accent: #FFE66D;
        }

        .game-container {
            max-width: 800px;
            margin: 2rem auto;
            padding: 3rem;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
        }

        h1 {
            color: var(--dark);
            margin-bottom: 2rem;
            font-size: 2.5rem;
        }

        .emoji-container {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin: 3rem 0;
            flex-wrap: wrap;
        }

        .emoji {
            font-size: 4rem;
            transition: all 0.3s;
        }

        .emoji:hover {
            transform: scale(1.2) rotate(10deg);
        }

        .answer-form {
            margin: 2rem 0;
        }

        .answer-input {
            padding: 1rem 1.5rem;
            font-size: 1.2rem;
            width: 70%;
            border: 2px solid #eee;
            border-radius: 50px;
            outline: none;
            transition: all 0.3s;
        }

        .answer-input:focus {
            border-color: var(--secondary);
            box-shadow: 0 0 10px rgba(78, 205, 196, 0.3);
        }

        .btn-submit {
            display: block;
            margin: 2rem auto 0;
            padding: 1rem 3rem;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-submit:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4);
            background: #ff5252;
        }

        .game-info {
            display: flex;
            justify-content: space-around;
            margin: 2rem 0;
            padding: 1.5rem;
            background: #f9f9f9;
            border-radius: 15px;
            font-size: 1.1rem;
        }

        .score, .timer {
            font-weight: bold;
            color: var(--dark);
        }

        .alert {
            padding: 1rem;
            border-radius: 10px;
            margin: 1rem 0;
            font-weight: bold;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
        }

        .alert-error {
            background: #f8d7da;
            color: #721c24;
        }
    </style>
{% endblock %}

{% block body %}
    <div class="game-container">
        <h1>Devinez la combinaison</h1>
        
        <div class="game-info">
            <div class="score">Score: <span>{{ app.session.get('score', 0) }}</span></div>
            <div class="timer">Temps: <span id="timer">60</span>s</div>
        </div>

        {% if question %}
            <div class="emoji-container">
                <div class="emoji">{{ question.emoji1 }}</div>
                <div class="emoji">{{ question.emoji2 }}</div>
                <div class="emoji">{{ question.emoji3 }}</div>
            </div>

            <form class="answer-form" action="{{ path('app_game_check') }}" method="POST">
                <input type="hidden" name="question_id" value="{{ question.id }}">
                <input type="text" 
                       class="answer-input" 
                       name="user_answer" 
                       placeholder="Entrez votre réponse..." 
                       required
                       autofocus>
                <button type="submit" class="btn-submit">Valider</button>
            </form>
        {% else %}
            <p class="no-questions">Aucune question disponible pour le moment</p>
        {% endif %}

        {% for message in app.flashes('success') %}
            <div class="alert alert-success">{{ message }}</div>
        {% endfor %}

        {% for message in app.flashes('error') %}
            <div class="alert alert-error">{{ message }}</div>
        {% endfor %}
    </div>

    <script>
        // Timer
        let timeLeft = 60;
        const timerElement = document.getElementById('timer');
        
        const timer = setInterval(() => {
            timeLeft--;
            timerElement.textContent = timeLeft;
            
            if(timeLeft <= 0) {
                clearInterval(timer);
                alert("Temps écoulé ! Votre score final : " + {{ app.session.get('score', 0) }});
                window.location.href = "{{ path('app_acceuil') }}";
            }
        }, 1000);
    </script>
{% endblock %}
